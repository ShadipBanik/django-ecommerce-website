{% extends 'shop/basic.html' %}
{% block body %}
<div class="container my-5">

  <div class="row">
    <!-- Left: Main Content -->
    <div class="col-lg-8">
      <h2 class="mb-4">Your Shopping Cart</h2>

      <div id="cart-items-list" class="list-group">
        <!-- Cart items will be rendered here by JS -->
      </div>

      <div class="mt-3">
        <h5>Total: $<span id="cart-total">0.00</span></h5>
        <button class="btn btn-success btn-lg mt-2" onclick="checkout()">Proceed to Checkout</button>
      </div>
    </div>

    <!-- Right: Sliding Sidebar -->

  </div>
</div>

<script>
// Load cart from localStorage
let cart = JSON.parse(localStorage.getItem("cart")) || {};

// Render cart items in main list and sidebar
function renderCart() {
    const list = document.getElementById("cart-items-list");
<!--    const sidebar = document.getElementById("sidebar-items");-->
    list.innerHTML = "";
<!--    sidebar.innerHTML = "";-->
    let total = 0;

    for (let id in cart) {
        const item = cart[id];
        const subtotal = item.price * item.quantity;
        total += subtotal;

        // Main cart item
        const li = document.createElement("div");
        li.className = "list-group-item d-flex justify-content-between align-items-center";
        li.innerHTML = `
            <div>
                <h6>${item.name}</h6>
                <p>$${item.price} x
                <input type="number" min="1" value="${item.quantity}" style="width:60px;" onchange="updateQuantity('${id}', this.value)">
                = $${subtotal.toFixed(2)}</p>
            </div>
            <button class="btn btn-danger btn-sm" onclick="removeItem('${id}')">&times;</button>
        `;
        list.appendChild(li);


    }

    document.getElementById("cart-total").innerText = total.toFixed(2);
    updateCartCount();
}

// Update cart count (can be used for navbar too)
function updateCartCount() {
    let count = 0;
    for (let id in cart) count += cart[id].quantity;
    const navbarCount = document.getElementById("navbar-cart-count");
    if(navbarCount) navbarCount.innerText = count;
}
updateCartCount();

// Quantity change handler
function updateQuantity(id, qty) {
    qty = parseInt(qty);
    if (qty < 1) qty = 1;
    cart[id].quantity = qty;
    localStorage.setItem("cart", JSON.stringify(cart));
    renderCart();
}

// Remove item
function removeItem(id) {
    delete cart[id];
    localStorage.setItem("cart", JSON.stringify(cart));
    renderCart();
}

// Checkout button
function checkout() {
    alert("Proceeding to checkout...");
    // Here you can redirect to a checkout page
}

// Sidebar toggle


// Initial render
renderCart();
</script>
<style>

</style>

{% endblock %}
